## 关闭连接（四次挥手）
![](images/tcp建立连接.png)
由于TCP连接是可以双向通信的（全双工），因此每个方向都必须单独进行关闭。

这原则是当一方完成它的数据发送任务后就能发送一个FIN来终止这个方向的连接。收到一个 FIN只意味着这一方向上没有数据流动，一个TCP连接在收到一个FIN后仍能发送数据。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。

客户端发出段7，FIN位表示关闭连接的请求。

服务器发出段8，应答客户端的关闭连接请求。

服务器发出段9，其中也包含FIN位，向客户端发送关闭连接请求。

客户端发出段10，应答服务器的关闭连接请求。

建立连接的过程是三次握手，而关闭连接通常需要4个段，服务器的应答和关闭连接请求通常不合并在一个段中，因为有连接半关闭的情况，这种情况下客户端关闭连接之后就不能再发送数据给服务器了，但是服务器还可以发送数据给客户端，直到服务器也关闭连接为止。